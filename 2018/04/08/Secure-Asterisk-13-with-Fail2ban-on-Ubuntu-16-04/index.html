<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="IntroductionFail2ban is a brute-force detection system that analyzes the log files on your system to figure out failed login attempts to various services and block them. By default, it uses iptables t"><meta name="keywords" content="asterisk,security,voip"><meta property="og:type" content="article"><meta property="og:title" content="Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><meta property="og:url" content="https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/index.html"><meta property="og:site_name" content="Cyphercodes"><meta property="og:description" content="IntroductionFail2ban is a brute-force detection system that analyzes the log files on your system to figure out failed login attempts to various services and block them. By default, it uses iptables t"><meta property="og:locale" content="en"><meta property="og:updated_time" content="2018-04-09T10:29:42.259Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><meta name="twitter:description" content="IntroductionFail2ban is a brute-force detection system that analyzes the log files on your system to figure out failed login attempts to various services and block them. By default, it uses iptables t"><link rel="shortcut icon" href="/images/cypher-favicon.ico"><link rel="icon" type="image/png" href="/images/cypher-android-chrome-144x144.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/cypher-apple-touch-icon.png"><title>Secure Asterisk 13 with Fail2ban on Ubuntu 16.04</title><link rel="stylesheet" href="/css/style.css"></head><body class="max-width mx-auto px3"><div id="header-post"><a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")' style="display:none"><i class="fas fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/searche">Search</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="/2018/04/09/Pushing-objects-from-an-observable-overwrites-previous-data-in-array/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"><ul><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/"><i class="fab fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&text=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&title=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&is_video=false&description=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04&body=Check out this article: https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/"><i class="fas fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&title=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&title=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&title=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&title=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-digg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.tumblr.com/share/link?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&name=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04&description="><i class="fab fa-tumblr" aria-hidden="true"></i></a></li></ul></div><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Configuration"><span class="toc-number">2.</span> <span class="toc-text">Configuration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Recommended-Configuration"><span class="toc-number">3.</span> <span class="toc-text">Recommended Configuration:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify-that-Fail2ban-is-working"><span class="toc-number">4.</span> <span class="toc-text">Verify that Fail2ban is working</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tips"><span class="toc-number">5.</span> <span class="toc-text">Tips</span></a></li></ol></div></span></div><div class="content index my4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Secure Asterisk 13 with Fail2ban on Ubuntu 16.04</h1><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Cyphercodes</span></span><div class="postdate"><time datetime="2018-04-08T19:11:31.000Z" itemprop="datePublished">2018-04-08</time></div><div class="article-tag"><i class="fas fa-tag"></i> <a class="tag-link" href="/tags/asterisk/">asterisk</a>, <a class="tag-link" href="/tags/security/">security</a>, <a class="tag-link" href="/tags/voip/">voip</a></div></div></header><div class="content" itemprop="articleBody"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Fail2ban is a brute-force detection system that analyzes the log files on your system to figure out failed login attempts to various services and block them. By default, it uses <code>iptables</code> to block attacking IP addresses.</p><p>When trying to set up Fail2ban with Asterisk, the Asterisk jail file that comes with your installed Fail2ban version may not always be compatible with your Asterisk version and you may face issues such as attacks not getting blocked or error messages like:</p><figure class="highlight vhdl"><table><tr><td class="code"><pre><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">15</span>:<span class="number">53</span>:<span class="number">26</span>,<span class="number">494</span> fail2ban.filter         [<span class="number">10340</span>]: <span class="literal">ERROR</span>   No <span class="symbol">'host</span>' <span class="keyword">group</span> <span class="keyword">in</span> <span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"FailedACL"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*'</span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">15</span>:<span class="number">53</span>:<span class="number">26</span>,<span class="number">494</span> fail2ban.transmitter    [<span class="number">10340</span>]: <span class="literal">WARNING</span> Command [<span class="symbol">'set</span>', <span class="symbol">'asterisk</span>', <span class="symbol">'addfailregex</span>', <span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"FailedACL"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*'] has failed. Received RegexException(<span class="symbol">'No</span> \<span class="symbol">'host\'</span> <span class="keyword">group</span> <span class="keyword">in</span> \<span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"FailedACL"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*\'',)</span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">15</span>:<span class="number">53</span>:<span class="number">26</span>,<span class="number">496</span> fail2ban.filter         [<span class="number">10340</span>]: <span class="literal">ERROR</span>   No <span class="symbol">'host</span>' <span class="keyword">group</span> <span class="keyword">in</span> <span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"InvalidAccountID"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*'</span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">15</span>:<span class="number">53</span>:<span class="number">26</span>,<span class="number">497</span> fail2ban.transmitter    [<span class="number">10340</span>]: <span class="literal">WARNING</span> Command [<span class="symbol">'set</span>', <span class="symbol">'asterisk</span>', <span class="symbol">'addfailregex</span>', <span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"InvalidAccountID"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*'] has failed. Received RegexException(<span class="symbol">'No</span> \<span class="symbol">'host\'</span> <span class="keyword">group</span> <span class="keyword">in</span> \<span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"InvalidAccountID"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*\'',)</span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">15</span>:<span class="number">53</span>:<span class="number">26</span>,<span class="number">497</span> fail2ban.filter         [<span class="number">10340</span>]: <span class="literal">ERROR</span>   No <span class="symbol">'host</span>' <span class="keyword">group</span> <span class="keyword">in</span> <span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"ChallengeResponseFailed"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*'</span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">15</span>:<span class="number">53</span>:<span class="number">26</span>,<span class="number">498</span> fail2ban.transmitter    [<span class="number">10340</span>]: <span class="literal">WARNING</span> Command [<span class="symbol">'set</span>', <span class="symbol">'asterisk</span>', <span class="symbol">'addfailregex</span>', <span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"ChallengeResponseFailed"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*'] has failed. Received RegexException(<span class="symbol">'No</span> \<span class="symbol">'host\'</span> <span class="keyword">group</span> <span class="keyword">in</span> \<span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"ChallengeResponseFailed"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*\'',)</span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">15</span>:<span class="number">53</span>:<span class="number">26</span>,<span class="number">499</span> fail2ban.filter         [<span class="number">10340</span>]: <span class="literal">ERROR</span>   No <span class="symbol">'host</span>' <span class="keyword">group</span> <span class="keyword">in</span> <span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"InvalidPassword"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*'</span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">08</span> <span class="number">15</span>:<span class="number">53</span>:<span class="number">26</span>,<span class="number">499</span> fail2ban.transmitter    [<span class="number">10340</span>]: <span class="literal">WARNING</span> Command [<span class="symbol">'set</span>', <span class="symbol">'asterisk</span>', <span class="symbol">'addfailregex</span>', <span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"InvalidPassword"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*'] has failed. Received RegexException(<span class="symbol">'No</span> \<span class="symbol">'host\'</span> <span class="keyword">group</span> <span class="keyword">in</span> \<span class="symbol">'SECURITY</span>.* SecurityEvent=<span class="string">"InvalidPassword"</span>.*RemoteAddress=<span class="string">".+?/.+?//.+?"</span>.*\'',)</span><br></pre></td></tr></table></figure><p>I will share a working configuration tested with:</p><ul><li>Ubuntu 16.04</li><li>Asterisk 13.19.0</li><li>Fail2Ban 0.9.3</li></ul><h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p><strong><code>/etc/fail2ban/filter.d/asterisk.conf</code>:</strong></p><figure class="highlight livescript"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Fail2Ban filter for asterisk authentication failures</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[INCLUDES]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read common prefixes. If any customizations available -- read them from</span></span><br><span class="line"><span class="comment"># common.local</span></span><br><span class="line">before = common.conf</span><br><span class="line"></span><br><span class="line">[Definition]</span><br><span class="line"></span><br><span class="line">_daemon = asterisk</span><br><span class="line"></span><br><span class="line">__pid_re = (?:<span class="string">\s*\[\d+\])</span></span><br><span class="line"></span><br><span class="line">iso8601 = <span class="string">\d&#123;4&#125;-\d&#123;2&#125;-\d&#123;2&#125;T\d&#123;2&#125;:\d&#123;2&#125;:\d&#123;2&#125;\.\d+[+-]\d&#123;4&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># All Asterisk log messages begin like this:</span></span><br><span class="line">log_prefix= (?:NOTICE|SECURITY|WARNING)%(__pid_re)s:?(?:<span class="string">\[C-[\da-f]*\])?:?</span> [^:]+:<span class="string">\d*(?:(?:</span> <span class="keyword">in</span>)? [^:]+:)?</span><br><span class="line"></span><br><span class="line">prefregex = ^%(__prefix_line)s%(log_prefix)s &lt;F-CONTENT&gt;.+&lt;/F-CONTENT&gt;$</span><br><span class="line"></span><br><span class="line">failregex = ^Registration <span class="keyword">from</span> <span class="string">'[^'</span>]*<span class="string">' failed for '</span>&lt;HOST&gt;(:<span class="string">\d+)?'</span> - (?:Wrong password|Username/auth name mismatch|No matching peer found|Not a local domain|Device does <span class="keyword">not</span> match ACL|Peer <span class="keyword">is</span> <span class="keyword">not</span> supposed <span class="keyword">to</span> register|ACL error <span class="string">\(permit/deny\)|Not</span> a local domain)$</span><br><span class="line">            ^Call <span class="keyword">from</span> <span class="string">'[^'</span>]*<span class="string">' \(&lt;HOST&gt;:\d+\) to extension '</span>[^<span class="string">']*'</span> rejected because extension <span class="keyword">not</span> found <span class="keyword">in</span> context</span><br><span class="line">            ^(?:Host )?&lt;HOST&gt; (?:failed (?:<span class="keyword">to</span> authenticate<span class="string">\b|MD5</span> authentication<span class="string">\b)|tried</span> <span class="keyword">to</span> authenticate <span class="keyword">with</span> nonexistent user<span class="string">\b)</span></span><br><span class="line">            ^No registration <span class="keyword">for</span> peer <span class="string">'[^'</span>]*<span class="string">' \(from &lt;HOST&gt;\)$</span></span><br><span class="line"><span class="string">            ^hacking attempt detected '</span>&lt;HOST&gt;<span class="string">'$</span></span><br><span class="line"><span class="string">            ^SecurityEvent="(?:FailedACL|InvalidAccountID|ChallengeResponseFailed|InvalidPassword)"(?:(?:,(?!RemoteAddress=)\w+="[^"]*")*|.*?),RemoteAddress="IPV[46]/(UDP|TCP|WS)/&lt;HOST&gt;/\d+"(?:,(?!RemoteAddress=)\w+="[^"]*")*$</span></span><br><span class="line"><span class="string">            ^"Rejecting unknown SIP connection from &lt;HOST&gt;"$</span></span><br><span class="line"><span class="string">            ^Request (?:'</span>[^<span class="string">']*'</span> )?<span class="keyword">from</span> <span class="string">'(?:[^'</span>]*|.*?)<span class="string">' failed for '</span>&lt;HOST&gt;(?::<span class="string">\d+)?'\s\(callid:</span> [^<span class="string">\)]*\)</span> - (?:No matching endpoint found|Not match Endpoint(?: Contact)? ACL|(?:Failed|Error) <span class="keyword">to</span> authenticate)<span class="string">\s*$</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># FreePBX (<span class="doctag">todo:</span> make optional in v.0.10):</span></span><br><span class="line"><span class="comment">#            ^(%(__prefix_line)s|\[\]\s*WARNING%(__pid_re)s:?(?:\[C-[\da-f]*\])? )[^:]+: Friendly Scanner from &lt;HOST&gt;$</span></span><br><span class="line"></span><br><span class="line">ignoreregex =</span><br><span class="line"></span><br><span class="line">datepattern = &#123;^LN-BEG&#125;</span><br></pre></td></tr></table></figure><p><strong><code>/etc/fail2ban/jail.local</code>:</strong></p><p>In the <code>jail.local</code> file, you have to uncomment or add the following asterisk jail:</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">[asterisk]</span><br><span class="line">enabled  = <span class="literal">true</span></span><br><span class="line">port     = 5060,5061</span><br><span class="line">action   = %(banaction)s[<span class="attribute">name</span>=%(__name__)s-tcp, <span class="attribute">port</span>=<span class="string">"%(port)s"</span>, <span class="attribute">protocol</span>=<span class="string">"tcp"</span>, <span class="attribute">chain</span>=<span class="string">"%(chain)s"</span>, <span class="attribute">actname</span>=%(banaction)s-tcp]</span><br><span class="line">           %(banaction)s[<span class="attribute">name</span>=%(__name__)s-udp, <span class="attribute">port</span>=<span class="string">"%(port)s"</span>, <span class="attribute">protocol</span>=<span class="string">"udp"</span>, <span class="attribute">chain</span>=<span class="string">"%(chain)s"</span>, <span class="attribute">actname</span>=%(banaction)s-udp]</span><br><span class="line">           %(mta)s-whois[<span class="attribute">name</span>=%(__name__)s, <span class="attribute">dest</span>=<span class="string">"%(destemail)s"</span>]</span><br><span class="line">logpath  = /var/log/asterisk/security</span><br><span class="line">maxretry = 3</span><br></pre></td></tr></table></figure><h2 id="Recommended-Configuration"><a href="#Recommended-Configuration" class="headerlink" title="Recommended Configuration:"></a>Recommended Configuration:</h2><p>In <code>/etc/fail2ban/jail.local</code>, it is also recommended to set the configurations below to make your system more secure:</p><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="comment"># "bantime" is the number of seconds that a host is banned.</span></span><br><span class="line"><span class="attr">bantime</span>  = <span class="number">172800</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A host is banned if it has generated "maxretry" during the last "findtime"</span></span><br><span class="line"><span class="comment"># seconds.</span></span><br><span class="line"><span class="attr">findtime</span>  = <span class="number">1200</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># "maxretry" is the number of failures before a host get banned.</span></span><br><span class="line"><span class="attr">maxretry</span> = <span class="number">3</span></span><br></pre></td></tr></table></figure><p><code>bantime</code> is increased to 2 days, <code>findtime</code> increased to 20 minutes, and <code>maxretry</code> is decreased to 3 attempts.</p><h2 id="Verify-that-Fail2ban-is-working"><a href="#Verify-that-Fail2ban-is-working" class="headerlink" title="Verify that Fail2ban is working"></a>Verify that Fail2ban is working</h2><p>First reload fail2ban:</p><figure class="highlight axapta"><table><tr><td class="code"><pre><span class="line">fail2ban-<span class="keyword">client</span> reload</span><br></pre></td></tr></table></figure><p>Check the status of the asterisk filter:</p><figure class="highlight axapta"><table><tr><td class="code"><pre><span class="line">fail2ban-<span class="keyword">client</span> status asterisk</span><br></pre></td></tr></table></figure><p>If you can see a list of blocked IPs then your fail2ban is running and properly detecting brute-force attacks on your Asterisk system!</p><p>It means you have properly secured your Asterisk box.</p><h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><p>If you Asterisk version is different, you may need a different Asterisk filter file for Fail2ban to work properly.</p><p>The best resource for you to find different versions of the Asterisk filter log is Fail2banâ€™s official Github repository:</p><p><a href="https://github.com/fail2ban/fail2ban" target="_blank" rel="noopener">https://github.com/fail2ban/fail2ban</a></p><p>There you may go to <code>config/filter.d/asterisk.conf</code> and click on history to find all the different versions of that filter file and start testing them with your Asterisk version.</p><p>Usually, if you are using a recent and stable Asterisk and Fail2ban version, the latest file present there should work best with your setup.</p></div></article><div class="blog-post-comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the comments.</noscript></div></div></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/">Home</a></li><li><a href="/searche">Search</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Configuration"><span class="toc-number">2.</span> <span class="toc-text">Configuration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Recommended-Configuration"><span class="toc-number">3.</span> <span class="toc-text">Recommended Configuration:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify-that-Fail2ban-is-working"><span class="toc-number">4.</span> <span class="toc-text">Verify that Fail2ban is working</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tips"><span class="toc-number">5.</span> <span class="toc-text">Tips</span></a></li></ol></div><div id="share-footer" style="display:none"><ul><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&text=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&title=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&is_video=false&description=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04&body=Check out this article: https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&title=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&title=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&title=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&title=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.tumblr.com/share/link?url=https://cyphercodes.github.io/2018/04/08/Secure-Asterisk-13-with-Fail2ban-on-Ubuntu-16-04/&name=Secure Asterisk 13 with Fail2ban on Ubuntu 16.04&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><a id="menu" class="icon" href="#" onclick='return $("#nav-footer").toggle(),!1'><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a> <a id="toc" class="icon" href="#" onclick='return $("#toc-footer").toggle(),!1'><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a> <a id="share" class="icon" href="#" onclick='return $("#share-footer").toggle(),!1'><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a> <a id="top" style="display:none" class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2018 Rayan Salhab</div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/searche">Search</a></li></ul></nav></div></footer></body></html><link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css"><link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css"><script src="/lib/jquery/jquery.min.js"></script><script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script><script src="/js/main.js"></script><script type="text/javascript">var disqus_shortname="cyphercodes-github-io-1";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script>